function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{QiYe:function(e,t,n){"use strict";n.r(t);var r=n("ofXK"),a=n("3Pt+"),i=n("tyNb"),s=n("TEn/"),l=n("mrSG"),o=n("lGQG"),d=n("wd/R"),c=n("IfdK"),h=n("MO+k"),m=n("xG9w"),u=n("fXoL"),p=["barChart"],f=["lineChart"];function b(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"ion-title"),u["\u0275\u0275text"](1,"Overall performance analysis"),u["\u0275\u0275elementEnd"]())}function v(e,t){1&e&&u["\u0275\u0275element"](0,"canvas",6,7)}function g(e,t){1&e&&u["\u0275\u0275element"](0,"canvas",8,9)}var _,y=((_=function(){function e(t,n,r){_classCallCheck(this,e),this.modalCtl=t,this.navParams=n,this.authService=r}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;"overall"===this.navParams.get("type")?(this.chartype=1,this.labels=this.navParams.get("reports"),setTimeout((function(){e.authService.dismiss(),e.overallChart()}),2e3)):(this.authService.presentLoading(),setTimeout((function(){e.authService.dismiss(),e.createChart()}),2e3))}},{key:"createChart",value:function(){var e;new Array,this.exam_marks=new Array,e=this.navParams.get("reports"),this.name=e.class_name,this.term=e.term_name,this.exam_marks=void 0===e.exam_marks?[]:e.exam_marks,console.log(e),this.terms=[],this.type=[];for(var t=[],n=0;n<e.exam_marks.length;n++)t.push(e.exam_marks[n].exam_type);for(var r=[],a=0;a<this.exam_marks.length;a++)for(var i=0;i<this.exam_marks[a].exam_marks.length;i++)null!==this.exam_marks[a].exam_marks[i].mark&&r.push(this.exam_marks[a].exam_type);t=r.filter(this.onlyUnique),console.log(t),this.math=[],this.english=[],this.kiswahili=[],this.science=[],this.ssre=[];for(var s=0;s<this.exam_marks.length;s++){var l=void 0;l=(l=m.a(this.exam_marks[s].exam_marks,"subject_name")).filter((function(e){return null==e.parent_subject_id})),this.math.push(l[0].mark),this.english.push(l[1].mark),this.kiswahili.push(l[2].mark),this.science.push(l[3].mark),this.ssre.push(l[4].mark)}for(var o=[],d=0;d<this.exam_marks[0].exam_marks.length;d++){var c;null==(c=m.a(this.exam_marks[0].exam_marks,"subject_name"))[d].parent_subject_id&&o.push(c[d].subject_name)}null==this.terms&&null==this.terms||(this.math=this.math.filter((function(e){return null!=e})),this.english=this.english.filter((function(e){return null!=e})),this.kiswahili=this.kiswahili.filter((function(e){return null!=e})),this.science=this.science.filter((function(e){return null!=e})),this.ssre=this.ssre.filter((function(e){return null!=e})),this.bars=new h.Chart(this.barChart.nativeElement,{type:"bar",data:{labels:t,datasets:[{label:o[0],data:this.math,fill:!0,borderWidth:2,backgroundColor:"orange"},{label:o[1],data:this.english,borderWidth:2,fill:!0,backgroundColor:"black"},{label:o[2],data:this.kiswahili,borderWidth:2,backgroundColor:"blue",fill:!0},{label:o[3],data:this.science,borderWidth:2,backgroundColor:"red",fill:!0},{label:o[4],data:this.ssre,borderWidth:2,backgroundColor:"green",fill:!0}]},options:{title:{display:!0,text:"Analysis for "+e.class_name+" "+e.term_name},maintainAspectRatio:!1,legend:{display:!0,position:"bottom"},gridLines:{display:!1},scales:{yAxes:[{scaleLabel:{display:!0,labelString:"EXAM MARKS",fontStyle:"bold"},ticks:{beginAtZero:!0,suggestedMax:100}}],xAxes:[{scaleLabel:{display:!0,labelString:"EXAM TYPE",fontStyle:"bold"},ticks:{}}]}}}))}},{key:"overallChart",value:function(){var e=[],t=[];this.labels=this.labels;for(var n=0;n<this.labels.length;n++)if(e.push(this.labels[n].overall_marks_and_grade[0].this_term_marks_and_grade[0].overall_mark.substr(0,3)),this.labels[n].term_name.length>10)this.labels[n].term_name.includes("ONE")?(r=this.labels[n].term_name.replace("ONE","1"),t.push(r)):this.labels[n].term_name.includes("TWO")?(r=this.labels[n].term_name.replace("TWO","2"),t.push(r)):this.labels[n].term_name.includes("THREE")?(r=this.labels[n].term_name.replace("THREE","3"),t.push(r)):t.push(this.labels[n].term_name);else if(this.labels[n].term_name.includes("ONE"))r=this.labels[n].term_name.replace("ONE","1"),t.push(r+" "+this.labels[n].year);else if(this.labels[n].term_name.includes("TWO"))r=this.labels[n].term_name.replace("TWO","2"),t.push(r+" "+this.labels[n].year);else if(this.labels[n].term_name.includes("THREE")){var r;r=this.labels[n].term_name.replace("THREE","3"),t.push(r+" "+this.labels[n].year)}else t.push(this.labels[n].term_name+" "+this.labels[n].year);console.log(e),console.log(t),this.str_lines=new h.Chart(this.ovChart.nativeElement,{type:"line",data:{labels:t,datasets:[{label:"OVERALL MARKS",data:e,fill:!0,borderWidth:2,backgroundColor:"rgba(57,124,73,0.3)",borderColor:"#397C49"}]},options:{title:{display:!1,text:"Overall performance"},maintainAspectRatio:!1,legend:{display:!0,position:"top"},scales:{yAxes:[{scaleLabel:{display:!0,labelString:"OVERALL MARKS",fontStyle:"bold"},ticks:{display:!0,beginAtZero:!0,suggestedMax:500,stepSize:100}}],xAxes:[{scaleLabel:{display:!0,labelString:"TERMS",fontStyle:"bold"},ticks:{display:!0}}]}}})}},{key:"onlyUnique",value:function(e,t,n){return n.indexOf(e)===t}},{key:"dismisModal",value:function(){this.modalCtl.dismiss()}}]),e}()).\u0275fac=function(e){return new(e||_)(u["\u0275\u0275directiveInject"](s.Q),u["\u0275\u0275directiveInject"](s.S),u["\u0275\u0275directiveInject"](o.a))},_.\u0275cmp=u["\u0275\u0275defineComponent"]({type:_,selectors:[["app-analytics-modal"]],viewQuery:function(e,t){var n;1&e&&(u["\u0275\u0275viewQuery"](p,!0),u["\u0275\u0275viewQuery"](f,!0)),2&e&&(u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.barChart=n.first),u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.ovChart=n.first))},decls:11,vars:5,consts:[[4,"ngIf"],["slot","end"],["slot","end",3,"click"],["name","close-circle"],["style","width: 250px;",4,"ngIf"],["style","height: 250px;",4,"ngIf"],[2,"width","250px"],["barChart",""],[2,"height","250px"],["lineChart",""]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"ion-header"),u["\u0275\u0275elementStart"](1,"ion-toolbar"),u["\u0275\u0275elementStart"](2,"ion-title"),u["\u0275\u0275text"](3),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](4,b,2,0,"ion-title",0),u["\u0275\u0275elementStart"](5,"ion-buttons",1),u["\u0275\u0275elementStart"](6,"ion-button",2),u["\u0275\u0275listener"]("click",(function(){return t.dismisModal()})),u["\u0275\u0275element"](7,"ion-icon",3),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](8,"ion-content"),u["\u0275\u0275template"](9,v,2,0,"canvas",4),u["\u0275\u0275template"](10,g,2,0,"canvas",5),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate2"]("",t.name," ",t.term," "),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",1===t.chartype),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("ngIf",1!==t.chartype),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",1===t.chartype))},directives:[s.q,s.L,s.K,r.i,s.g,s.f,s.r,s.l],styles:[""]}),_),k=["lineChart"],x=["lineChart2"],C=["lineChart3"],S=["overallChart"];function E(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"ion-avatar",9),u["\u0275\u0275element"](1,"img",10),u["\u0275\u0275elementEnd"]()),2&e){var n=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275propertyInterpolate"]("src",n.assets,u["\u0275\u0275sanitizeUrl"])}}function w(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"ion-avatar",9),u["\u0275\u0275element"](1,"ion-icon",11),u["\u0275\u0275elementEnd"]())}function O(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"div",12),u["\u0275\u0275elementStart"](1,"ion-item",13),u["\u0275\u0275text"](2,"No analytic information for this student."),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]())}function M(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"ion-select-option",31),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;u["\u0275\u0275advance"](1),u["\u0275\u0275propertyInterpolate"]("value",n),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](n)}}function I(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275elementStart"](1,"ion-select-option",31),u["\u0275\u0275text"](2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;u["\u0275\u0275advance"](1),u["\u0275\u0275propertyInterpolate"]("value",n.term_id),u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate"](n.term_name)}}function A(e,t){1&e&&u["\u0275\u0275element"](0,"canvas",37,38)}function j(e,t){1&e&&u["\u0275\u0275element"](0,"canvas",17,39)}function W(e,t){1&e&&u["\u0275\u0275element"](0,"canvas",17,40)}function P(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"ion-col",32),u["\u0275\u0275elementStart"](1,"div",18),u["\u0275\u0275listener"]("click",(function(){u["\u0275\u0275restoreView"](n);var e=t.$implicit;return u["\u0275\u0275nextContext"](2).openModal(e)})),u["\u0275\u0275elementStart"](2,"ion-card",33),u["\u0275\u0275template"](3,A,2,0,"canvas",34),u["\u0275\u0275template"](4,j,2,0,"canvas",35),u["\u0275\u0275template"](5,W,2,0,"canvas",35),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](6,"p",36),u["\u0275\u0275elementStart"](7,"strong"),u["\u0275\u0275text"](8),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,a=t.index;u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("ngIf",0==a),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",1==a),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",2==a),u["\u0275\u0275advance"](3),u["\u0275\u0275textInterpolate"](r.term_name)}}function R(e,t){if(1&e){var n=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div"),u["\u0275\u0275element"](1,"ion-icon",14,15),u["\u0275\u0275elementStart"](3,"i",16),u["\u0275\u0275text"](4,"Click on card to view detailed analysis"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"h5"),u["\u0275\u0275text"](6,"Overall performance"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](7,"ion-card",17),u["\u0275\u0275elementStart"](8,"canvas",18,19),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().ovModal()})),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](10,"ion-list"),u["\u0275\u0275elementStart"](11,"h5",20),u["\u0275\u0275text"](12,"Subject performance"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](13,"ion-list-header"),u["\u0275\u0275elementStart"](14,"ion-button",21),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().hide()})),u["\u0275\u0275text"](15,"Filter "),u["\u0275\u0275element"](16,"ion-icon",22),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](17,"div",23),u["\u0275\u0275elementStart"](18,"ion-item"),u["\u0275\u0275elementStart"](19,"ion-label"),u["\u0275\u0275text"](20,"Class"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](21,"ion-select",24),u["\u0275\u0275listener"]("ionChange",(function(e){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().classChange(e)})),u["\u0275\u0275elementStart"](22,"ion-select-option",25),u["\u0275\u0275text"](23,"All"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](24,M,3,2,"div",26),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](25,"ion-item"),u["\u0275\u0275elementStart"](26,"ion-label"),u["\u0275\u0275text"](27,"Term"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](28,"ion-select",27),u["\u0275\u0275listener"]("ionChange",(function(e){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().termChange(e)})),u["\u0275\u0275template"](29,I,3,2,"div",26),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](30,"ion-item",13),u["\u0275\u0275elementStart"](31,"ion-button",28),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](n),u["\u0275\u0275nextContext"]().filter()})),u["\u0275\u0275text"](32,"Filter"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](33,"ion-grid",29),u["\u0275\u0275elementStart"](34,"ion-row"),u["\u0275\u0275template"](35,P,9,4,"ion-col",30),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"]()}if(2&e){var r=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](24),u["\u0275\u0275property"]("ngForOf",r.class_history),u["\u0275\u0275advance"](5),u["\u0275\u0275property"]("ngForOf",r.terms),u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("ngForOf",r.report_cards)}}var T,L=((T=function(){function e(t,n,r,a,i){var s=this;_classCallCheck(this,e),this.authService=t,this.route=n,this.router=r,this.session=a,this.modalCtl=i,this.data=new Array,this.student=new Array,this.terms=[],this.segment="overall",this.marks=[],this.fake=0,this.hidden=!0,this.report_cards=new Array,this.class_history=new Array,this.exam_marks=new Array,this.route.queryParams.subscribe((function(e){s.router.getCurrentNavigation().extras.state&&(s.student=s.router.getCurrentNavigation().extras.state.details,s.assets=null===s.student.student_image?1:"https://".concat(s.student.school,".eduweb.co.ke/assets/students/").concat(s.student.student_image))})),this.options={title:{display:!1,text:"Analysis for "},legend:{display:!1},maintainAspectRatio:!1,responive:!0,scales:{yAxes:[{scaleLabel:{display:!1,labelString:"EXAM MARKS",fontStyle:"bold"},ticks:{display:!1,beginAtZero:!0,suggestedMax:100,stepSize:25},gridLines:{display:!0,lineWidth:1}}],xAxes:[{scaleLabel:{display:!1,labelString:"EXAM TYPE",fontStyle:"bold"},ticks:{display:!1},gridLines:{display:!0,lineWidth:1}}]}}}return _createClass(e,[{key:"ngOnInit",value:function(){this.authService.presentLoading()}},{key:"ionViewWillEnter",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.cards(this.student.school,this.student.student_id).subscribe((function(e){t.data=e,t.labels=m.a(t.data.data,"term_id");for(var n=[],r=0;r<t.labels.length;r++)n=t.labels[r].exam_marks;null==t.labels||0===t.labels.length||null===n?(t.nodata="true",t.authService.dismiss()):(t.nodata="false",t.report_cards=t.labels.reverse(),console.log(t.report_cards),"2020"===t.report_cards[0].year?(t.sort=1,t.report_cards=t.report_cards.filter((function(e){return"2020"==e.year}))):"2019"===t.report_cards[0].year?(t.sort=0,t.report_cards=t.report_cards.filter((function(e){return"2019"==e.year}))):"2018"===t.report_cards[0].year?(t.sort=0,t.report_cards=t.report_cards.filter((function(e){return"2018"==e.year}))):(t.nodata="true",t.authService.dismiss()),t.authService.dismiss(),t.pos=-1,setTimeout((function(){t.overallChart(),t.createChart(t.pos)}),2e3))}));case 2:return e.next=4,this.authService.schoolTerm(this.student.school,this.student.student_id).subscribe((function(e){t.data=e,t.terms=t.data.data,t.class_history=t.terms.map((function(e){return e.class_name})).filter((function(e,t,n){return n.indexOf(e)===t}))}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"reportData",value:function(e){this.router.navigate(["analysis"],{state:{details:this.student,reports:e}})}},{key:"hide",value:function(){var e=this;1==this.hidden?(document.getElementById("hid").hidden=!1,this.hidden=!1):(document.getElementById("hid").hidden=!0,this.hidden=!0,this.report_cards=this.labels.reverse(),"2020"===this.report_cards[0].year?(this.sort=1,this.report_cards=this.report_cards.filter((function(e){return"2020"==e.year}))):(this.sort=0,this.report_cards=this.report_cards.filter((function(e){return"2019"==e.year}))),setTimeout((function(){e.pos=-1,e.createChart(e.pos)}),2e3))}},{key:"classChange",value:function(e){var t=this;this.c_id=e.target.value,"all"===this.c_id?this.terms=this.data.data:(this.terms=this.data.data,this.terms=this.terms.filter((function(e){return e.class_name==t.c_id}))),console.log(this.terms)}},{key:"termChange",value:function(e){this.t_id=e.target.value}},{key:"filter",value:function(){var e,t=this;this.report_cards=void 0===this.data.data?[]:this.data.data,e=this.report_cards.filter((function(e){return e.term_id==t.t_id})),console.log(e[0]),this.pos=this.report_cards.indexOf(e[0]),console.log(this.pos),this.report_cards=this.report_cards.filter((function(e){return e.term_id==t.t_id})),setTimeout((function(){t.createChart(t.pos)}),2e3)}},{key:"createChart",value:function(e){if(console.log(e),-1!=e){for(var t=this.report_cards[0].exam_marks,n=[],r=0;r<t.length;r++)n.push(t[r].exam_type);console.log(n),this.math=[],this.english=[],this.kiswahli=[],this.science=[],this.ssre=[];for(var a=0;a<t.length;a++){var i=void 0;i=(i=m.a(t[a].exam_marks,"subject_name")).filter((function(e){return null==e.parent_subject_id})),this.math.push(i[0].mark),this.english.push(i[1].mark),this.kiswahli.push(i[2].mark),this.science.push(i[3].mark),this.ssre.push(i[4].mark)}for(var s=[],l=0;l<t[0].exam_marks.length;l++){var o;null==(o=m.a(t[0].exam_marks,"subject_name"))[l].parent_subject_id&&s.push(o[l].subject_name)}this.bars=new h.Chart(this.lineChart.nativeElement,{type:"bar",data:{labels:n,datasets:[{label:s[0],data:this.math,fill:!1,borderWidth:.5,borderColor:"orange"},{label:s[1],data:this.english,borderWidth:.5,fill:!1,borderColor:"black"},{label:s[2],data:this.kiswahli,borderWidth:.5,borderColor:"blue",fill:!1},{label:s[3],data:this.science,borderWidth:.5,borderColor:"red",fill:!1},{label:s[4],data:this.ssre,borderWidth:.5,borderColor:"green",fill:!1}]},options:this.options})}else{for(a=0;a<this.report_cards.length;a++)this.exam_marks.push(this.report_cards[a].exam_marks);var d=this.exam_marks[0],c=this.exam_marks[1],u=this.exam_marks[2];console.log(d[0].exam_marks);var p=[];for(l=0;l<d[0].exam_marks.length;l++){var f;null==(f=m.a(d[0].exam_marks,"subject_name"))[l].parent_subject_id&&p.push(f[l].subject_name)}this.terms=[];for(var b,v=[],g=[],_=[],y=0;y<d.length;y++)v.push(d[y].exam_type);this.math=[],this.english=[],this.kiswahli=[],this.science=[],this.ssre=[];for(var k=0;k<d.length;k++)b=(b=m.a(d[k].exam_marks,"subject_name")).filter((function(e){return null==e.parent_subject_id})),this.math.push(b[0].mark),this.english.push(b[1].mark),this.kiswahli.push(b[2].mark),this.science.push(b[3].mark),this.ssre.push(b[4].mark);this.bars=new h.Chart(this.lineChart.nativeElement,{type:"bar",data:{labels:v,datasets:[{label:p[0],data:this.math,fill:!1,borderWidth:.5,borderColor:"orange"},{label:p[1],data:this.english,borderWidth:.5,fill:!1,borderColor:"black"},{label:p[2],data:this.kiswahli,borderWidth:.5,borderColor:"blue",fill:!1},{label:p[3],data:this.science,borderWidth:.5,borderColor:"red",fill:!1},{label:p[4],data:this.ssre,borderWidth:.5,borderColor:"green",fill:!1}]},options:this.options});for(var x=0;x<c.length;x++)g.push(c[x].exam_type);if(void 0!==u)for(var C=0;C<u.length;C++)_.push(u[C].exam_type);var S,E=[],w=[],O=[],M=[],I=[];for(a=0;a<c.length;a++)S=(S=m.a(c[a].exam_marks,"subject_name")).filter((function(e){return null==e.parent_subject_id})),E.push(S[0].mark),w.push(S[1].mark),O.push(S[2].mark),M.push(S[3].mark),I.push(S[4].mark);var A=[],j=[],W=[],P=[],R=[];if(void 0!==u)for(a=0;a<u.length;a++){var T=void 0;T=(T=m.a(u[a].exam_marks,"subject_name")).filter((function(e){return null==e.parent_subject_id})),A.push(T[0].mark),j.push(T[1].mark),W.push(T[2].mark),P.push(T[3].mark),R.push(T[4].mark)}E=E.filter((function(e){return null!=e})),w=w.filter((function(e){return null!=e})),O=O.filter((function(e){return null!=e})),M=M.filter((function(e){return null!=e})),I=I.filter((function(e){return null!=e})),this.lines=new h.Chart(this.lineChart2.nativeElement,{type:"bar",data:{labels:g,datasets:[{label:p[0],data:E,fill:!1,borderWidth:.5,borderColor:"orange"},{label:p[1],data:w,borderWidth:.5,fill:!1,borderColor:"black"},{label:p[2],data:O,borderWidth:.5,borderColor:"blue",fill:!1},{label:p[3],data:M,borderWidth:.5,borderColor:"red",fill:!1},{label:p[4],data:I,borderWidth:.5,borderColor:"green",fill:!1}]},options:this.options}),this.pies=new h.Chart(this.lineChart3.nativeElement,{type:"bar",data:{labels:_,datasets:[{label:p[0],data:A,fill:!1,borderWidth:.5,borderColor:"orange"},{label:p[1],data:j,borderWidth:.5,fill:!1,borderColor:"black"},{label:p[2],data:W,borderWidth:.5,borderColor:"blue",fill:!1},{label:p[3],data:P,borderWidth:.5,borderColor:"red",fill:!1},{label:p[4],data:R,borderWidth:.5,borderColor:"green",fill:!1}]},options:this.options})}}},{key:"overallChart",value:function(){var e=[],t=[];this.labels=m.a(this.labels,"term_id");for(var n=0;n<this.labels.length;n++)e.push(this.labels[n].overall_marks_and_grade[0].this_term_marks_and_grade[0].overall_mark.substr(0,3)),t.push(this.labels[n].term_name);console.log(e),console.log(t),this.str_lines=new h.Chart(this.ovChart.nativeElement,{type:"line",data:{labels:t,datasets:[{label:"Overall Marks",data:e,fill:!0,borderWidth:2,backgroundColor:"rgba(57,124,73,0.3)",borderColor:"#397C49"}]},options:{maintainAspectRatio:!1,scales:{yAxes:[{scaleLabel:{display:!1,labelString:"Ov MARKS",fontStyle:"bold"},ticks:{display:!0,beginAtZero:!0,suggestedMax:500,stepSize:250}}],xAxes:[{scaleLabel:{display:!0,labelString:"TERMS",fontStyle:"bold"},ticks:{display:!1}}]}}})}},{key:"openModal",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtl.create({component:y,cssClass:"modal-css",componentProps:{reports:e}});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ovModal",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtl.create({component:y,cssClass:"modal-css",componentProps:{reports:this.labels,type:"overall"}});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"onlyUnique",value:function(e,t,n){return n.indexOf(e)===t}},{key:"format",value:function(e){return d(e).format("DD-MM-YYYY")}}]),e}()).\u0275fac=function(e){return new(e||T)(u["\u0275\u0275directiveInject"](o.a),u["\u0275\u0275directiveInject"](i.a),u["\u0275\u0275directiveInject"](i.g),u["\u0275\u0275directiveInject"](c.a),u["\u0275\u0275directiveInject"](s.Q))},T.\u0275cmp=u["\u0275\u0275defineComponent"]({type:T,selectors:[["app-analytics"]],viewQuery:function(e,t){var n;1&e&&(u["\u0275\u0275viewQuery"](k,!0),u["\u0275\u0275viewQuery"](x,!0),u["\u0275\u0275viewQuery"](C,!0),u["\u0275\u0275viewQuery"](S,!0)),2&e&&(u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.lineChart=n.first),u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.lineChart2=n.first),u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.lineChart3=n.first),u["\u0275\u0275queryRefresh"](n=u["\u0275\u0275loadQuery"]())&&(t.ovChart=n.first))},decls:13,vars:7,consts:[["color","primary"],["slot","start",2,"font-size","14px"],["text","","icon","chevron-back"],[2,"--background","none"],["slot","start",4,"ngIf"],[2,"text-transform","uppercase"],[1,"ion-padding"],["class","vertical-center",4,"ngIf"],[4,"ngIf"],["slot","start"],[3,"src"],["size","32","name","happy-outline",2,"font-size","2em"],[1,"vertical-center"],["lines","none"],["size","medium","name","information-circle",2,"padding-top","10px","color","#397C49"],["helper",""],[2,"color","#397C49"],[2,"height","180px"],[3,"click"],["overallChart",""],[2,"margin-bottom","-5px"],["size","small",2,"color","black",3,"click"],["name","chevron-down"],["id","hid","hidden","",2,"padding-left","8px","padding-right","8px"],["id","class","cancelText","Cancel","okText","Ok",3,"ionChange"],["value","all"],[4,"ngFor","ngForOf"],["cancelText","Cancel","okText","Ok",3,"ionChange"],["slot","end","color","dark",3,"click"],[1,"grid_graphs"],["size","6","style","margin: -5px;",4,"ngFor","ngForOf"],[3,"value"],["size","6",2,"margin","-5px"],["tooltip","Okay lets see","positionV","bottom"],["style","height: 180px; width: 200px;",4,"ngIf"],["style","height: 180px;",4,"ngIf"],[2,"text-align","center"],[2,"height","180px","width","200px"],["lineChart",""],["lineChart2",""],["lineChart3",""]],template:function(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"ion-header"),u["\u0275\u0275elementStart"](1,"ion-toolbar",0),u["\u0275\u0275elementStart"](2,"ion-buttons",1),u["\u0275\u0275element"](3,"ion-back-button",2),u["\u0275\u0275text"](4,"ANALYTICS "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](5,"ion-item",3),u["\u0275\u0275template"](6,E,2,1,"ion-avatar",4),u["\u0275\u0275template"](7,w,2,0,"ion-avatar",4),u["\u0275\u0275elementStart"](8,"ion-label",5),u["\u0275\u0275text"](9),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](10,"ion-content",6),u["\u0275\u0275template"](11,O,3,0,"div",7),u["\u0275\u0275template"](12,R,36,3,"div",8),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("ngIf",1!==t.assets),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",1===t.assets),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate3"]("",t.student.first_name," ",t.student.middle_name," ",t.student.last_name," "),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf","true"===t.nodata),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.report_cards.length>0))},directives:[s.q,s.L,s.g,s.d,s.e,s.t,r.i,s.u,s.l,s.c,s.r,s.h,s.v,s.w,s.f,s.E,s.V,s.F,r.h,s.p,s.B,s.k],styles:["ion-segment[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{text-transform:unset;color:#fff;font-size:12px}ion-content[_ngcontent-%COMP%]{font-size:12px;--ion-background-color:#dddede}ion-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{color:#000;font-size:12px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{--background:none}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{--ion-background-color:#fff;padding:8px}ion-content[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{color:#000;font-size:12px}#class[_ngcontent-%COMP%]{max-width:65%!important}ion-select[_ngcontent-%COMP%]{width:100%;justify-content:center}.center[_ngcontent-%COMP%]{text-align:right}.grid_graphs[_ngcontent-%COMP%]{margin:-8px}ion-item[_ngcontent-%COMP%]{--border-color:#fff}"]}),T);n.d(t,"AnalyticsPageModule",(function(){return V}));var Q,z=[{path:"",component:L}],V=((Q=function e(){_classCallCheck(this,e)}).\u0275mod=u["\u0275\u0275defineNgModule"]({type:Q}),Q.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(e){return new(e||Q)},imports:[[r.b,a.FormsModule,s.M,i.i.forChild(z)]]}),Q)}}]);