(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{Ip41:function(e,t,n){"use strict";n.r(t);var a=n("ofXK"),o=n("3Pt+"),r=n("tyNb"),i=n("TEn/"),s=n("mrSG"),l=n("lGQG"),d=n("wd/R"),m=n("IfdK"),c=n("fXoL");const u=["absentForm"];function g(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"small",39),c["\u0275\u0275elementStart"](1,"i"),c["\u0275\u0275text"](2,"change start date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]())}function h(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"small",39),c["\u0275\u0275elementStart"](1,"i"),c["\u0275\u0275text"](2,"change end date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]())}function p(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275element"](1,"ion-spinner",40),c["\u0275\u0275elementEnd"]())}function f(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"small"),c["\u0275\u0275elementStart"](2,"i",41),c["\u0275\u0275text"](3,"No Absent Records for student."),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]())}function v(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"ion-item",42),c["\u0275\u0275elementStart"](1,"ion-grid",43),c["\u0275\u0275listener"]("click",(function(){c["\u0275\u0275restoreView"](e);const n=t.index;return c["\u0275\u0275nextContext"](2).showInfo(n)})),c["\u0275\u0275elementStart"](2,"ion-row"),c["\u0275\u0275elementStart"](3,"small"),c["\u0275\u0275elementStart"](4,"strong"),c["\u0275\u0275text"](5,"Absent due to"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](7,"ion-row",44),c["\u0275\u0275elementStart"](8,"small"),c["\u0275\u0275elementStart"](9,"strong"),c["\u0275\u0275text"](10,"Duration:"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](11),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](12,"div",45),c["\u0275\u0275elementStart"](13,"ion-row"),c["\u0275\u0275elementStart"](14,"small"),c["\u0275\u0275elementStart"](15,"strong"),c["\u0275\u0275text"](16,"Your note: "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](17,' "'),c["\u0275\u0275elementStart"](18,"i"),c["\u0275\u0275text"](19),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](20,'" '),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](21,"ion-row"),c["\u0275\u0275elementStart"](22,"ion-col",46),c["\u0275\u0275elementStart"](23,"small"),c["\u0275\u0275elementStart"](24,"strong"),c["\u0275\u0275text"](25,"From: "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](26),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](27,"ion-col",46),c["\u0275\u0275elementStart"](28,"small"),c["\u0275\u0275elementStart"](29,"strong"),c["\u0275\u0275text"](30,"To: "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275text"](31),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,a=c["\u0275\u0275nextContext"](2);c["\u0275\u0275advance"](6),c["\u0275\u0275textInterpolate1"](" ",e.reason,""),c["\u0275\u0275advance"](1),c["\u0275\u0275propertyInterpolate1"]("id","duration",n,""),c["\u0275\u0275advance"](4),c["\u0275\u0275textInterpolate2"](" ",a.duration[n]," day(s) of ",a.month[n],""),c["\u0275\u0275advance"](1),c["\u0275\u0275propertyInterpolate1"]("id","content",n,""),c["\u0275\u0275advance"](7),c["\u0275\u0275textInterpolate"](e.message),c["\u0275\u0275advance"](7),c["\u0275\u0275textInterpolate1"](" ",a.formatDate(e.starting),""),c["\u0275\u0275advance"](5),c["\u0275\u0275textInterpolate"](a.formatDate(e.ending))}}const S=function(e){return{border:e}};function x(e,t){if(1&e){const e=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"div",11),c["\u0275\u0275elementStart"](2,"h4"),c["\u0275\u0275text"](3,"Report Absenteeism"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](4,"p",12),c["\u0275\u0275text"](5,"Select the child/children and reason for absenteeism and enter the specific date or date range the student(s) will be absent."),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"form",13,14),c["\u0275\u0275listener"]("ngSubmit",(function(){c["\u0275\u0275restoreView"](e);const t=c["\u0275\u0275reference"](7);return c["\u0275\u0275nextContext"]().reportAbsent(t)})),c["\u0275\u0275elementStart"](8,"ion-item",15),c["\u0275\u0275elementStart"](9,"ion-label",16),c["\u0275\u0275text"](10,"Student(s) "),c["\u0275\u0275element"](11,"ion-icon",17),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](12,"ion-input",18),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](13,"ion-item",19),c["\u0275\u0275elementStart"](14,"ion-label",20),c["\u0275\u0275text"](15,"Reason "),c["\u0275\u0275element"](16,"ion-icon",21),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](17,"ion-select",22),c["\u0275\u0275listener"]("ionChange",(function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().reasonChange(t)})),c["\u0275\u0275elementStart"](18,"ion-select-option",23),c["\u0275\u0275text"](19,"Travel"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](20,"ion-select-option",24),c["\u0275\u0275text"](21,"Sickness"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](22,"ion-select-option",25),c["\u0275\u0275text"](23,"Bereavment"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](24,"ion-select-option",26),c["\u0275\u0275text"](25,"Other"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](26,"ion-item",27),c["\u0275\u0275elementStart"](27,"ion-label",20),c["\u0275\u0275text"](28," Period "),c["\u0275\u0275element"](29,"ion-icon",28),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](30,"ion-datetime",29),c["\u0275\u0275listener"]("ngModelChange",(function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().from_date=t}))("ngModelChange",(function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().fromDate(t)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](31,g,3,0,"small",30),c["\u0275\u0275element"](32,"br"),c["\u0275\u0275elementStart"](33,"ion-datetime",31),c["\u0275\u0275listener"]("ngModelChange",(function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().to_date=t}))("ngModelChange",(function(t){return c["\u0275\u0275restoreView"](e),c["\u0275\u0275nextContext"]().toDate(t)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](34,h,3,0,"small",30),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](35,"ion-item",32),c["\u0275\u0275elementStart"](36,"ion-label",33),c["\u0275\u0275text"](37,"Message "),c["\u0275\u0275element"](38,"ion-icon",34),c["\u0275\u0275elementEnd"](),c["\u0275\u0275element"](39,"ion-textarea",35),c["\u0275\u0275elementStart"](40,"ion-button",36),c["\u0275\u0275text"](41,"Report Absenteeism"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](42,"div",11),c["\u0275\u0275elementStart"](43,"h4"),c["\u0275\u0275text"](44,"Absent Days"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](45,"p",12),c["\u0275\u0275text"](46,"Below are the days the student was absent from school. "),c["\u0275\u0275elementStart"](47,"i"),c["\u0275\u0275elementStart"](48,"small"),c["\u0275\u0275text"](49,"(Click for more info.)"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](50,"ion-list"),c["\u0275\u0275template"](51,p,2,0,"div",37),c["\u0275\u0275template"](52,f,4,0,"div",37),c["\u0275\u0275template"](53,v,32,8,"ion-item",38),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){const e=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](12),c["\u0275\u0275propertyInterpolate"]("value",e.student),c["\u0275\u0275property"]("readonly",e.isReadonly()),c["\u0275\u0275advance"](18),c["\u0275\u0275property"]("ngStyle",c["\u0275\u0275pureFunction1"](11,S,"true"==e.valid?"solid 1px red":"solid 1px slategray"))("ngModel",e.from_date),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","true"==e.valid),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngStyle",c["\u0275\u0275pureFunction1"](13,S,"true"==e.valid?"solid 1px red":"solid 1px slategray"))("ngModel",e.to_date),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf","true"==e.valid),c["\u0275\u0275advance"](17),c["\u0275\u0275property"]("ngIf",0==e.fake&&0==e.absent_days.length),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",1==e.fake&&0==e.absent_days.length),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngForOf",e.absent_days)}}function b(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"div",47),c["\u0275\u0275element"](2,"ion-icon",48),c["\u0275\u0275element"](3,"br"),c["\u0275\u0275elementStart"](4,"i"),c["\u0275\u0275elementStart"](5,"strong",41),c["\u0275\u0275text"](6,"Coming soon"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]())}let E=(()=>{class e{constructor(e,t,n,a){this.authServices=e,this.router=t,this.route=n,this.sessionService=a,this.valid="false",this.state="off",this.route.queryParams.subscribe(e=>{this.router.getCurrentNavigation().extras.state&&(this.student=this.router.getCurrentNavigation().extras.state.details.student_name,this.student_id=this.router.getCurrentNavigation().extras.state.details.student_id,this.sub_domain=this.router.getCurrentNavigation().extras.state.details.school_subdomain,this.class_name=this.router.getCurrentNavigation().extras.state.details.class_name,this.details=this.router.getCurrentNavigation().extras.state.details,null==this.sub_domain&&(this.sub_domain=this.router.getCurrentNavigation().extras.state.details.school),this.assets=null===this.student.student_image?1:`https://${this.student.school}.eduweb.co.ke/assets/students/${this.student.student_image}`)}),this.absent_days=new Array,this.sessionService.sessionTimeOut(),this.duration=new Array,this.month=new Array,this.starting_dates=new Array,this.fake=0,setTimeout(()=>{this.fake=1},3e3)}ngOnInit(){this.segment="absenteeism",this.message="Hello, \n"}ionViewWillEnter(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.authServices.getAbsenteeism(this.student_id,this.sub_domain).subscribe(e=>{if(this.data=e,"success"===this.data.response){this.absent_days=void 0===this.data.data?[]:this.data.data,console.log(this.absent_days);for(var t=0;t<this.absent_days.length;t++){const e=864e5;var n=new Date(this.data.data[t].starting),a=new Date(this.data.data[t].ending);this.starting_dates.push(d(n).format("MMM, Do YYYY")),console.log(this.starting_dates),this.month.push(this.getMonth(n));for(var o=n.getTime(),r=a.getTime(),i=0,s=o;s<r;s+=e){var l=new Date(s);5!==l.getDay()&&6!==l.getDay()||i++}var m=Math.round(Math.abs(n.getTime()-a.getTime())/e)+1;this.duration.push(m-i)}}})}))}reasonChange(e){document.getElementById("hid").hidden=!1,this.message=this.message+"Due to "+e.detail.value+", "+this.student+" ("+this.class_name+") shall not be in schoool from "}fromDate(e){this.message=this.message+this.formatDate(e)+" to ",this.valid="false"}toDate(e){document.getElementById("hid2").hidden=!1,this.message=this.message+this.formatDate(e)+". \nThank you.",this.valid="false"}showInfo(e){1==document.getElementById("content"+e).hidden?(document.getElementById("content"+e).hidden=!1,document.getElementById("duration"+e).hidden=!0):(document.getElementById("content"+e).hidden=!0,document.getElementById("duration"+e).hidden=!1)}reportAbsent(e){console.log(e.value);var t=d(e.value.from_date).format("MMM, ddd YYYY"),n=d(e.value.to_date).format("MMM, ddd YYYY"),a=new Date(e.value.from_date),o=new Date(e.value.to_date);console.log(a),console.log(o),document.querySelector("app-attendance").querySelector("ion-content").scrollToTop(1500),console.log("end "+o.getTime()),console.log("start "+a.getTime()),o.getTime()>a.getTime()?this.starting_dates.includes(d(a).format("MMM, Do YYYY"))?(this.authServices.presentAlert2("Duplicate entry. \n Student already reported absent for dates selected."),e.reset()):this.authServices.reportAbsenteeism(this.student_id,e.value.message,e.value.reason,e.value.from_date,e.value.to_date,this.sub_domain,t,n).subscribe(e=>{this.data=e,"success"===this.data.response?(this.authServices.presentAlert2(this.data.data),this.router.navigate(["home"],{state:{details:this.details}})):this.authServices.presentAlert2(this.data.data)}):(this.authServices.presentAlert2("Check dates and try again. \n Start date should be before End date"),e.reset(),document.querySelector("app-attendance").querySelector("ion-content").scrollToTop(1500),this.valid="true")}segmentChanged(e){}checkWeekend(e,t){}isReadonly(){return this.isReadonly}formatDate(e){return d(e).format("MMM D, YYYY")}getMonth(e){return d(e).format("MMMM")}}return e.\u0275fac=function(t){return new(t||e)(c["\u0275\u0275directiveInject"](l.a),c["\u0275\u0275directiveInject"](r.g),c["\u0275\u0275directiveInject"](r.a),c["\u0275\u0275directiveInject"](m.a))},e.\u0275cmp=c["\u0275\u0275defineComponent"]({type:e,selectors:[["app-attendance"]],viewQuery:function(e,t){var n;1&e&&c["\u0275\u0275viewQuery"](u,!0),2&e&&c["\u0275\u0275queryRefresh"](n=c["\u0275\u0275loadQuery"]())&&(t.absentForm=n.first)},decls:17,vars:5,consts:[["color","primary"],["slot","start",2,"font-size","14px"],["text","","icon","chevron-back"],[2,"text-transform","uppercase"],["value","absenteeism","mode","md",3,"ngModel","ionChange","ngModelChange"],["value","absenteeism"],[2,"color","white !important"],["value","attendance"],["overflow-scroll","true",3,"scrollEvents"],[3,"ngSwitch"],[4,"ngSwitchCase"],[2,"background-color","white","margin","10px","padding","10px","border-radius","5px"],[1,"text"],["method","post",3,"ngSubmit"],["absentForm","ngForm"],["lines","none"],["name","students","position","stacked",2,"margin-bottom","5px"],["small","","name","people"],[3,"value","readonly"],["lines","none",1,"no-ripple"],["position","stacked",2,"margin-bottom","5px"],["small","","name","help-circle"],["ngModel","","name","reason",3,"ionChange"],["value","Travel"],["value","Sickness"],["value","Bereavment"],["value","other"],["id","hid","hidden","","lines","none"],["small","","name","calendar"],["name","from_date","placeholder","From","displayFormat","DD MMM YYYY","doneText","Ok","cancelText","Cancel",3,"ngStyle","ngModel","ngModelChange"],["style","color: red;",4,"ngIf"],["name","to_date","placeholder","To","displayFormat","DD MMM YYYY","doneText","Ok","cancelText","Cancel",3,"ngStyle","ngModel","ngModelChange"],["id","hid2","hidden","","lines","none"],["position","stacked"],["small","","name","document-text"],["ngModel","","cols","20","rows","7","name","message","maxlength","500"],["id","sub_button","type","submit"],[4,"ngIf"],["id","absentItem","lines","full",4,"ngFor","ngForOf"],[2,"color","red"],["name","lines-small","color","primary",2,"text-align","center","margin-left","50%","margin-right","50%"],[2,"color","#397C49"],["id","absentItem","lines","full"],[3,"click"],[3,"id"],["hidden","",3,"id"],["col-6",""],[1,"center"],["name","construct",2,"zoom","3.0"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"ion-header"),c["\u0275\u0275elementStart"](1,"ion-toolbar",0),c["\u0275\u0275elementStart"](2,"ion-buttons",1),c["\u0275\u0275element"](3,"ion-back-button",2),c["\u0275\u0275elementStart"](4,"div",3),c["\u0275\u0275text"](5," attendance"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"ion-segment",4),c["\u0275\u0275listener"]("ionChange",(function(e){return t.segmentChanged(e)}))("ngModelChange",(function(e){return t.segment=e})),c["\u0275\u0275elementStart"](7,"ion-segment-button",5),c["\u0275\u0275elementStart"](8,"ion-label",6),c["\u0275\u0275text"](9,"Absenteeism"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](10,"ion-segment-button",7),c["\u0275\u0275elementStart"](11,"ion-label",6),c["\u0275\u0275text"](12,"Attendance"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](13,"ion-content",8),c["\u0275\u0275elementStart"](14,"div",9),c["\u0275\u0275template"](15,x,54,15,"div",10),c["\u0275\u0275template"](16,b,7,0,"div",10),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](6),c["\u0275\u0275property"]("ngModel",t.segment),c["\u0275\u0275advance"](7),c["\u0275\u0275property"]("scrollEvents",!0),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngSwitch",t.segment),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngSwitchCase","absenteeism"),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngSwitchCase","attendance"))},directives:[i.q,i.L,i.g,i.d,i.e,i.C,i.V,o.NgControlStatus,o.NgModel,i.D,i.u,i.l,a.k,a.l,o["\u0275angular_packages_forms_forms_y"],o.NgControlStatusGroup,o.NgForm,i.t,i.r,i.s,i.W,i.E,i.F,i.m,a.j,a.i,i.J,o.MaxLengthValidator,i.f,i.v,a.h,i.H,i.p,i.B,i.k],styles:["ion-card-title[_ngcontent-%COMP%]{font-size:18px!important;margin:0}ion-card-subtitle[_ngcontent-%COMP%]{text-transform:none;font-style:normal}.text[_ngcontent-%COMP%], ion-card-title[_ngcontent-%COMP%], ion-input[_ngcontent-%COMP%], ion-label[_ngcontent-%COMP%], ion-select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif!important;color:#000}ion-datetime[_ngcontent-%COMP%], ion-input[_ngcontent-%COMP%], ion-select[_ngcontent-%COMP%], ion-textarea[_ngcontent-%COMP%]{border:1px solid #708090;border-radius:8px;padding-left:10px!important}ion-col[_ngcontent-%COMP%], ion-row[_ngcontent-%COMP%]{size:11px;margin-bottom:5px}ion-content[_ngcontent-%COMP%]{--background:#d3d3d3}.no-ripple[_ngcontent-%COMP%]{--ripple-color:transparent;--background-activated:transparent}.center[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);padding:10px;align-content:center;text-align:center}"]}),e})();n.d(t,"AttendancePageModule",(function(){return M}));const y=[{path:"",component:E}];let M=(()=>{class e{}return e.\u0275mod=c["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.b,o.FormsModule,i.M,r.i.forChild(y)]]}),e})()}}]);