(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{V14W:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("3Pt+"),r=n("tyNb"),a=n("TEn/"),s=n("mrSG"),l=n("lGQG"),c=n("IfdK"),d=n("wd/R"),m=n("m/P+"),p=n("xS7M"),f=n("te5A"),u=n("B7Rs"),h=n("FAH8"),v=n("3LUQ"),g=n("fXoL"),x=n("jhN1");function S(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"ion-avatar",10),g["\u0275\u0275element"](1,"img",11),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"]();g["\u0275\u0275advance"](1),g["\u0275\u0275propertyInterpolate"]("src",e.assets,g["\u0275\u0275sanitizeUrl"])}}function E(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"ion-avatar",10),g["\u0275\u0275element"](1,"ion-icon",12),g["\u0275\u0275elementEnd"]())}function b(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"ion-list"),g["\u0275\u0275element"](1,"br"),g["\u0275\u0275element"](2,"ion-spinner",13),g["\u0275\u0275elementEnd"]())}function I(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"ion-card"),g["\u0275\u0275elementStart"](1,"ion-item"),g["\u0275\u0275text"](2," No Resources "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]())}function y(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"div"),g["\u0275\u0275element"](1,"ion-icon",21),g["\u0275\u0275elementEnd"]())}function w(e,t){1&e&&g["\u0275\u0275element"](0,"ion-icon",22)}function k(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div"),g["\u0275\u0275element"](1,"iframe",24),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"](2).$implicit;g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("src",e.vimeo_path_full,g["\u0275\u0275sanitizeResourceUrl"])}}function _(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"a",25),g["\u0275\u0275text"](1),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"](2).$implicit;g["\u0275\u0275propertyInterpolate1"]("href","https://player.vimeo.com/video/",e.vimeo_path,"",g["\u0275\u0275sanitizeUrl"]),g["\u0275\u0275advance"](1),g["\u0275\u0275textInterpolate"](e.file_name)}}function C(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div"),g["\u0275\u0275elementStart"](1,"ion-row"),g["\u0275\u0275template"](2,k,2,1,"div",16),g["\u0275\u0275template"](3,_,2,2,"ng-template",null,23,g["\u0275\u0275templateRefExtractor"]),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275reference"](4),t=g["\u0275\u0275nextContext"](3);g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf","iOS"===t.platform)("ngIfElse",e)}}function j(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"div"),g["\u0275\u0275elementStart"](1,"ion-row",26),g["\u0275\u0275listener"]("click",(function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"]().$implicit,n=g["\u0275\u0275nextContext"](2);return n.download(t.file_name,n.link+t.file_name)})),g["\u0275\u0275text"](2),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}if(2&e){const e=g["\u0275\u0275nextContext"]().$implicit;g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"](" ",e.file_name," ")}}function z(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div"),g["\u0275\u0275elementStart"](1,"ion-item"),g["\u0275\u0275template"](2,y,2,0,"div",16),g["\u0275\u0275template"](3,w,1,0,"ng-template",null,17,g["\u0275\u0275templateRefExtractor"]),g["\u0275\u0275elementStart"](5,"ion-grid"),g["\u0275\u0275elementStart"](6,"ion-row"),g["\u0275\u0275elementStart"](7,"ion-col",18),g["\u0275\u0275text"](8),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](9,"ion-row"),g["\u0275\u0275elementStart"](10,"ion-col",19),g["\u0275\u0275text"](11),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](12,C,5,2,"div",7),g["\u0275\u0275template"](13,j,3,1,"div",7),g["\u0275\u0275elementStart"](14,"ion-row"),g["\u0275\u0275element"](15,"ion-col",20),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](16,"ion-row"),g["\u0275\u0275elementStart"](17,"ion-col",20),g["\u0275\u0275elementStart"](18,"small"),g["\u0275\u0275text"](19),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=g["\u0275\u0275reference"](4),i=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf",e.file_name.includes("mp4"))("ngIfElse",n),g["\u0275\u0275advance"](6),g["\u0275\u0275textInterpolate1"](" ",e.resource_name," "),g["\u0275\u0275advance"](3),g["\u0275\u0275textInterpolate1"](" ",e.additional_text," "),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf","VIDEO"===e.resource_type),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf","DOCUMENT"===e.resource_type),g["\u0275\u0275advance"](6),g["\u0275\u0275textInterpolate2"]("",i.formatDate(e.creation_date),", By ",e.teacher_name,"")}}function R(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div",14),g["\u0275\u0275template"](1,z,20,8,"div",15),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"]();g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngForOf",e.resources)}}function M(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"ion-fab",27),g["\u0275\u0275listener"]("click",(function(){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"]().addfeed()})),g["\u0275\u0275elementStart"](1,"ion-fab-button",28),g["\u0275\u0275element"](2,"ion-icon",29),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}}let O=(()=>{class e{constructor(e,t,n,i,o,r,a,s,l,c,d){this.authService=e,this.sessionService=t,this.route=n,this.router=i,this.domSanitizer=o,this.iap=r,this.device=a,this.transfer=s,this.file=l,this.fileOpener=c,this.alertService=d,this.resources=new Array,this.fake=1,setTimeout(()=>{this.fake=0},6e3),this.sessionService.sessionTimeOut(),this.route.queryParams.subscribe(e=>{this.router.getCurrentNavigation().extras.state&&(this.student=this.router.getCurrentNavigation().extras.state.details,this.value=this.router.getCurrentNavigation().extras.state.resource,this.school=this.student.school,this.assets=null===this.student.student_image?1:`https://${this.student.school}.eduweb.co.ke/assets/students/${this.student.student_image}`,this.link=`https://cdn.eduweb.co.ke/resources/${this.school}/documents/`)})}ngOnInit(){this.platform=this.device.platform,console.log(this.platform)}ionViewWillEnter(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.authService.checkFeed().then(e=>{this.feedback=e}),yield this.authService.getResources(this.student.school,this.student.student_id).subscribe(e=>{this.data=e,this.resources=void 0!==this.data.data?this.data.data:[],this.resources.map(e=>e.vimeo_path),this.resources.forEach((e,t)=>{this.vidUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(`https://player.vimeo.com/video/${e.vimeo_path}`),e.vimeo_path_full=this.vidUrl})})}))}getMIMEtype(e){return{txt:"text/plain",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",doc:"application/msword",pdf:"application/pdf",jpg:"image/jpeg",bmp:"image/bmp",png:"image/png",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",rtf:"application/rtf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}[e.toLowerCase()]}open(e){this.authService.dismiss();const t=e.split(".").reverse()[0],n=this.getMIMEtype(t);console.log(t,n,e),this.fileOpener.showOpenWithDialog(e,n).then(()=>console.log("File is opened")).catch(e=>{this.alertService.presentToast(e)})}download(e,t){return Object(s.a)(this,void 0,void 0,(function*(){yield this.authService.presentLoading();const n=encodeURI(t);this.fileTransfer=this.transfer.create(),this.fileTransfer.download(n,this.file.dataDirectory+e,!0).then(e=>{console.log("download completed: "+e.toURL()),this.open(e.toURL())}).catch(t=>{this.authService.dismiss(),/\s/.test(e)&&this.alertService.presentToast("Download failed: File Name has spaces"),this.alertService.presentToast("Download failed: File not found"),console.log("download failed: File not found")})}))}formatDate(e){return d(e).format("MMM D, YYYY")}addfeed(){this.router.navigate(["feedback"],{})}}return e.\u0275fac=function(t){return new(t||e)(g["\u0275\u0275directiveInject"](l.a),g["\u0275\u0275directiveInject"](c.a),g["\u0275\u0275directiveInject"](r.a),g["\u0275\u0275directiveInject"](r.g),g["\u0275\u0275directiveInject"](x.DomSanitizer),g["\u0275\u0275directiveInject"](m.a),g["\u0275\u0275directiveInject"](p.a),g["\u0275\u0275directiveInject"](u.a),g["\u0275\u0275directiveInject"](h.a),g["\u0275\u0275directiveInject"](f.a),g["\u0275\u0275directiveInject"](v.a))},e.\u0275cmp=g["\u0275\u0275defineComponent"]({type:e,selectors:[["app-resources"]],decls:15,vars:9,consts:[["color","primary"],["slot","start",2,"font-size","14px"],["text","","icon","chevron-back"],["lines","none"],["slot","start",4,"ngIf"],[2,"text-transform","uppercase"],[1,"ion-no-padding"],[4,"ngIf"],["class","info",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",3,"click",4,"ngIf"],["slot","start"],[3,"src"],["size","32","name","happy-outline",2,"font-size","2em"],["name","lines-small","color","primary",2,"text-align","center","margin-left","50%","margin-right","50%"],[1,"info"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["doc",""],["col-6","",1,"info",2,"color","#009e0f","font-weight","bold","text-transform","uppercase","font-size","12px"],["col-6","",1,"info",2,"font-size","14px"],["col-12",""],["name","videocam",2,"position","relative","color","black"],["name","document-text",2,"position","relative","color","black"],["android",""],["width","100%","height","100%","frameborder","0","allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture; fullscreen","allowfullscreen","",3,"src"],[2,"font-size","14px","padding","08px","color","blue","text-decoration","none","border-bottom","blue 1px !important",3,"href"],[2,"font-size","14px","padding","08px","color","blue","border-bottom","blue 1px !important",3,"click"],["vertical","bottom","horizontal","end","slot","fixed",3,"click"],["color","tertiary"],["name","chatbox-ellipses"]],template:function(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"ion-header"),g["\u0275\u0275elementStart"](1,"ion-toolbar",0),g["\u0275\u0275elementStart"](2,"ion-buttons",1),g["\u0275\u0275element"](3,"ion-back-button",2),g["\u0275\u0275text"](4,"RESOURCES "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](5,"ion-item",3),g["\u0275\u0275template"](6,S,2,1,"ion-avatar",4),g["\u0275\u0275template"](7,E,2,0,"ion-avatar",4),g["\u0275\u0275elementStart"](8,"ion-label",5),g["\u0275\u0275text"](9),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](10,"ion-content",6),g["\u0275\u0275template"](11,b,3,0,"ion-list",7),g["\u0275\u0275template"](12,I,3,0,"ion-card",7),g["\u0275\u0275template"](13,R,2,1,"div",8),g["\u0275\u0275template"](14,M,3,0,"ion-fab",9),g["\u0275\u0275elementEnd"]()),2&e&&(g["\u0275\u0275advance"](6),g["\u0275\u0275property"]("ngIf",1!==t.assets),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",1===t.assets),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate3"]("",t.student.first_name," ",t.student.middle_name," ",t.student.last_name," "),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf",0===t.resources.length&&1===t.fake),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",0===t.resources.length&&0===t.fake),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",t.resources.length>0),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf","true"===t.feedback))},directives:[a.q,a.L,a.g,a.d,a.e,a.t,i.i,a.u,a.l,a.c,a.r,a.v,a.H,a.h,i.h,a.p,a.B,a.k,a.n,a.o],styles:[""]}),e})();n.d(t,"ResourcesPageModule",(function(){return D}));const U=[{path:"",component:O}];let D=(()=>{class e{}return e.\u0275mod=g["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.b,o.FormsModule,a.M,r.i.forChild(U)]]}),e})()}}]);